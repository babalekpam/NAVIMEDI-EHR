[root@mail NaviMed]# # Check current .env
cat .env

# Change back to SMTP_PASS with the correct password
sed -i 's/SMTP_PASSWORD=.*/SMTP_PASS=m0_04Id6x/' .env

# Verify
cat .env | grep SMTP

# Restart
pm2 restart navimed

# Check logs (should see NO SMTP errors!)
pm2 logs navimed --lines 20
NODE_ENV=production
PORT=5000

# Database - REAL CONNECTION STRING
DATABASE_URL=postgresql://neondb_owner:npg_vMTokQ6w9fey@ep-square-moon-aexpu2wb.c-2.us-east-2.aws.neon.tech/neondb?sslmode=require

# SMTP Email Configuration - REAL CREDENTIALS
SMTP_HOST=navimedi.org
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=no-reply@navimedi.org
SMTP_PASSWORD=m0_04Id6x

# Session Secret
SESSION_SECRET=navimed-production-secret-key-2025
JWT_SECRET=tWOicdp+2imhe/kGr+k++/d4kJVMvsS5nZgr4yuK648=
# SMTP Email Configuration - REAL CREDENTIALS
SMTP_HOST=navimedi.org
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=no-reply@navimedi.org
SMTP_PASS=m0_04Id6x
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [navimed](ids: [ 0 ])
[PM2] [navimed](0) âœ“
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name               â”‚ mode     â”‚ â†º    â”‚ status    â”‚ cpu      â”‚ memory   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ navimed            â”‚ fork     â”‚ 118  â”‚ online    â”‚ 0%       â”‚ 18.1mb   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[TAILING] Tailing last 20 lines for [navimed] process (change the value with --lines option)
/root/.pm2/logs/navimed-error-0.log last 20 lines:
0|navimed  | SMTP connection error: Error: Invalid login: 535 5.7.8 Error: authentication failed: authentication failure
0|navimed  |     at SMTPConnection._formatError (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:809:19)
0|navimed  |     at SMTPConnection._actionAUTHComplete (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:1595:34)
0|navimed  |     at SMTPConnection.<anonymous> (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:556:26)
0|navimed  |     at SMTPConnection._processResponse (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:993:20)
0|navimed  |     at SMTPConnection._onData (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:774:14)
0|navimed  |     at SMTPConnection._onSocketData (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:195:44)
0|navimed  |     at TLSSocket.emit (node:events:524:28)
0|navimed  |     at addChunk (node:internal/streams/readable:561:12)
0|navimed  |     at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
0|navimed  |     at Readable.push (node:internal/streams/readable:392:5)
0|navimed  |     at TLSWrap.onStreamRead (node:internal/stream_base_commons:191:23) {
0|navimed  |   code: 'EAUTH',
0|navimed  |   response: '535 5.7.8 Error: authentication failed: authentication failure',
0|navimed  |   responseCode: 535,
0|navimed  |   command: 'AUTH PLAIN'
0|navimed  | }
0|navimed  | SMTP environment variables not set. Email functionality will be disabled.
0|navimed  | Required: SMTP_HOST, SMTP_USER, SMTP_PASS
0|navimed  | âš ï¸ Stripe not initialized: STRIPE_SECRET_KEY must start with 'sk_'. Current key format: undefined

/root/.pm2/logs/navimed-out-0.log last 20 lines:
0|navimed  | âœ… Inventory management routes registered successfully
0|navimed  | ğŸ“š Registering patient engagement routes...
0|navimed  | âœ… Patient engagement routes registered successfully
0|navimed  | ğŸ”§ Registering developer portal routes...
0|navimed  | âœ… Developer portal routes registered successfully
0|navimed  | ğŸ“Š Registering analytics routes...
0|navimed  | ğŸ“Š Skipping duplicate platform-stats registration (exists in routes.ts)
0|navimed  | âœ… Analytics routes registered successfully
0|navimed  | ğŸ¥ Registering DICOM medical imaging routes...
0|navimed  | âœ… DICOM medical imaging routes registered successfully
0|navimed  | âœ… BI Reports endpoints registered successfully
0|navimed  | Server running on port 5000
0|navimed  | 1:54:23 AM [express] serving on port 5000
0|navimed  | 1:54:25 AM [express] ğŸŒ Initializing countries first...
0|navimed  | ğŸŒ Initializing default countries...
0|navimed  | âœ“ Comprehensive countries already initialized
0|navimed  | 1:54:26 AM [express] âœ“ Using Nigeria (b50f15cb-f548-4b9c-98ab-de565e05b70c) as platform tenant country
0|navimed  | 1:54:26 AM [express] âœ“ Platform tenant already exists
0|navimed  | 1:54:26 AM [express] âœ“ Super admin already exists
0|navimed  | 1:54:26 AM [express] âœ“ Platform initialization complete

0|navimed  | âš ï¸ Stripe not initialized: STRIPE_SECRET_KEY must start with 'sk_'. Current key format: undefined
0|navimed  | ğŸ§ª Registering simple test routes...
0|navimed  | âœ… Simple test routes registered successfully
0|navimed  | ğŸ”’ Applying security middleware for BREACH protection...
0|navimed  | ğŸ“¦ Registering inventory management routes...
0|navimed  | âœ… Inventory management routes registered successfully
0|navimed  | ğŸ“š Registering patient engagement routes...
0|navimed  | âœ… Patient engagement routes registered successfully
0|navimed  | ğŸ”§ Registering developer portal routes...
0|navimed  | âœ… Developer portal routes registered successfully
0|navimed  | ğŸ“Š Registering analytics routes...
0|navimed  | ğŸ“Š Skipping duplicate platform-stats registration (exists in routes.ts)
0|navimed  | âœ… Analytics routes registered successfully
0|navimed  | ğŸ¥ Registering DICOM medical imaging routes...
0|navimed  | âœ… DICOM medical imaging routes registered successfully
0|navimed  | âœ… BI Reports endpoints registered successfully
0|navimed  | Server running on port 5000
0|navimed  | 1:56:17 AM [express] serving on port 5000
0|navimed  | SMTP connection error: Error: Invalid login: 535 5.7.8 Error: authentication failed: authentication failure
0|navimed  |     at SMTPConnection._formatError (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:809:19)
0|navimed  |     at SMTPConnection._actionAUTHComplete (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:1595:34)
0|navimed  |     at SMTPConnection.<anonymous> (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:556:26)
0|navimed  |     at SMTPConnection._processResponse (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:993:20)
0|navimed  |     at SMTPConnection._onData (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:774:14)
0|navimed  |     at SMTPConnection._onSocketData (/var/www/vhosts/navimedi.org/httpdocs/NaviMed/node_modules/nodemailer/lib/smtp-connection/index.js:195:44)
0|navimed  |     at TLSSocket.emit (node:events:524:28)
0|navimed  |     at addChunk (node:internal/streams/readable:561:12)
0|navimed  |     at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
0|navimed  |     at Readable.push (node:internal/streams/readable:392:5)
0|navimed  |     at TLSWrap.onStreamRead (node:internal/stream_base_commons:191:23) {
0|navimed  |   code: 'EAUTH',
0|navimed  |   response: '535 5.7.8 Error: authentication failed: authentication failure',
0|navimed  |   responseCode: 535,
0|navimed  |   command: 'AUTH PLAIN'
0|navimed  | }
0|navimed  | 1:56:20 AM [express] ğŸŒ Initializing countries first...
0|navimed  | ğŸŒ Initializing default countries...
0|navimed  | âœ“ Comprehensive countries already initialized
0|navimed  | 1:56:20 AM [express] âœ“ Using Nigeria (b50f15cb-f548-4b9c-98ab-de565e05b70c) as platform tenant country
0|navimed  | 1:56:20 AM [express] âœ“ Platform tenant already exists
0|navimed  | 1:56:20 AM [express] âœ“ Super admin already exists
0|navimed  | 1:56:20 AM [express] âœ“ Platform initialization complete