import{as as V,r as g,au as Q,j as e,h,aC as q,ai as y,C as d,d as o,e as m,bn as z,g as x,bQ as G,bL as J,f as K,I as W,N as f,O as b,Q as w,V as S,W as l,X,Y,Z as A,_ as n,$ as Z,a0 as i,y as I,cU as _,a1 as L}from"./index-DHAHNq0D.js";function se(){const{token:P}=V(),[u,T]=g.useState(""),[p,D]=g.useState("all"),[j,F]=g.useState("all"),{data:r=[],isLoading:ee}=Q({queryKey:["/api/laboratory/billing"],queryFn:()=>Promise.resolve([{id:"1",transactionDate:"2025-01-29",patientName:"Malia Nkawula",testOrderId:"LAB001",testName:"Comprehensive Metabolic Panel (CMP)",insuranceProvider:"Blue Cross Blue Shield",insuranceClaim:125.5,patientCopay:25,totalAmount:150.5,paymentMethod:"card",status:"completed",claimStatus:"approved",notes:"Fasting test completed"},{id:"2",transactionDate:"2025-01-29",patientName:"Lekpam Nkawula",testOrderId:"LAB002",testName:"Thyroid Function Tests",insuranceProvider:"Aetna",insuranceClaim:89.75,patientCopay:20,totalAmount:109.75,paymentMethod:"insurance",status:"pending",claimStatus:"processing"},{id:"3",transactionDate:"2025-01-28",patientName:"Sarah Lee",testOrderId:"LAB003",testName:"Complete Blood Count (CBC)",insuranceProvider:"UnitedHealth",insuranceClaim:45.2,patientCopay:15,totalAmount:60.2,paymentMethod:"card",status:"completed",claimStatus:"approved"},{id:"4",transactionDate:"2025-01-28",patientName:"John Smith",testOrderId:"LAB004",testName:"Lipid Panel",insuranceProvider:"Humana",insuranceClaim:78.3,patientCopay:12,totalAmount:90.3,paymentMethod:"cash",status:"completed",claimStatus:"approved",notes:"Patient preferred cash payment"},{id:"5",transactionDate:"2025-01-27",patientName:"Emily Davis",testOrderId:"LAB005",testName:"Hemoglobin A1C",totalAmount:65.8,patientCopay:65.8,insuranceClaim:0,paymentMethod:"card",status:"completed",notes:"No insurance coverage"},{id:"6",transactionDate:"2025-01-26",patientName:"Michael Johnson",testOrderId:"LAB006",testName:"Liver Function Panel",insuranceProvider:"Cigna",insuranceClaim:95.4,patientCopay:18,totalAmount:113.4,paymentMethod:"insurance",status:"failed",claimStatus:"denied",notes:"Prior authorization required"}]),staleTime:3e4}),B=t=>{const s={completed:{color:"bg-green-100 text-green-800",text:"Completed"},pending:{color:"bg-yellow-100 text-yellow-800",text:"Pending"},failed:{color:"bg-red-100 text-red-800",text:"Failed"}},a=s[t]||s.completed;return e.jsx(L,{className:a.color,children:a.text})},$=t=>{if(!t)return null;const a={submitted:{color:"bg-blue-100 text-blue-800",text:"Submitted"},approved:{color:"bg-green-100 text-green-800",text:"Approved"},denied:{color:"bg-red-100 text-red-800",text:"Denied"},processing:{color:"bg-yellow-100 text-yellow-800",text:"Processing"}}[t];return a?e.jsx(L,{className:a.color,children:a.text}):null},M=t=>({cash:"ðŸ’µ Cash",card:"ðŸ’³ Card",insurance:"ðŸ¥ Insurance",check:"ðŸ“„ Check"})[t]||t,O=async t=>{try{if(!P){console.error("No authentication token found");return}const s=new Date().toLocaleDateString(),a=new Date(t.transactionDate).toLocaleDateString(),N=`INSURANCE CLAIM SUBMISSION
Laboratory: LABSAFE
Address: 789 Research Boulevard, Science City, SC 98765
Phone: 555-LAB-SAFE
Tax ID: 44-LABSAFE
CLIA Number: CLIA-LABSAFE-789

PATIENT INFORMATION
Name: ${t.patientName}
Test Order ID: ${t.testOrderId}
Service Date: ${a}

BILLING INFORMATION
Test Name: ${t.testName}
Insurance Provider: ${t.insuranceProvider||"N/A"}
Total Amount: $${t.totalAmount.toFixed(2)}
Insurance Claim: $${t.insuranceClaim.toFixed(2)}
Patient Copay: $${t.patientCopay.toFixed(2)}
Payment Method: ${t.paymentMethod}
Status: ${t.status}
Claim Status: ${t.claimStatus||"N/A"}

NOTES
${t.notes||"No additional notes"}

Generated: ${s}

---
This file is for insurance manual submission.
Please attach all required supporting documentation.
`,H=new Blob([N],{type:"text/plain"}),v=window.URL.createObjectURL(H),c=document.createElement("a");c.href=v,c.download=`insurance-claim-${t.testOrderId}-${t.patientName.replace(/\s+/g,"-")}.txt`,document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(v),document.body.removeChild(c),console.log("Insurance file downloaded successfully")}catch(s){console.error("Error downloading insurance file:",s)}},C=r.filter(t=>{const s=(t.patientName||"").toLowerCase().includes(u.toLowerCase())||(t.testName||"").toLowerCase().includes(u.toLowerCase())||(t.testOrderId||"").toLowerCase().includes(u.toLowerCase()),a=p==="all"||t.status===p,N=j==="all"||t.paymentMethod===j;return s&&a&&N}),R=r.reduce((t,s)=>t+s.totalAmount,0),k=r.reduce((t,s)=>t+s.insuranceClaim,0),E=r.reduce((t,s)=>t+s.patientCopay,0),U=r.filter(t=>t.status==="completed").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Laboratory Billing & Revenue"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track lab test payments, insurance claims, and financial reporting"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(h,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Export Report"]}),e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),"Generate Invoice"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx(z,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",R.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"This period"})]})]}),e.jsxs(d,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Insurance Claims"}),e.jsx(y,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",k.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Claimed from insurance"})]})]}),e.jsxs(d,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Patient Payments"}),e.jsx(G,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",E.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Patient copays & direct pay"})]})]}),e.jsxs(d,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Tests Completed"}),e.jsx(J,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:U}),e.jsx("p",{className:"text-xs text-gray-500",children:"Completed this period"})]})]})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Laboratory Transaction History"}),e.jsx(K,{children:"View and manage lab test billing transactions"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(W,{placeholder:"Search transactions...",value:u,onChange:t=>T(t.target.value),className:"w-80"}),e.jsxs(f,{value:p,onValueChange:D,children:[e.jsx(b,{className:"w-32",children:e.jsx(w,{placeholder:"Status"})}),e.jsxs(S,{children:[e.jsx(l,{value:"all",children:"All Status"}),e.jsx(l,{value:"completed",children:"Completed"}),e.jsx(l,{value:"pending",children:"Pending"}),e.jsx(l,{value:"failed",children:"Failed"})]})]}),e.jsxs(f,{value:j,onValueChange:F,children:[e.jsx(b,{className:"w-32",children:e.jsx(w,{placeholder:"Payment"})}),e.jsxs(S,{children:[e.jsx(l,{value:"all",children:"All Methods"}),e.jsx(l,{value:"cash",children:"Cash"}),e.jsx(l,{value:"card",children:"Card"}),e.jsx(l,{value:"insurance",children:"Insurance"}),e.jsx(l,{value:"check",children:"Check"})]})]})]})]})}),e.jsxs(x,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(X,{children:[e.jsx(Y,{children:e.jsxs(A,{children:[e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Patient"}),e.jsx(n,{children:"Lab Test"}),e.jsx(n,{children:"Insurance"}),e.jsx(n,{children:"Patient Pay"}),e.jsx(n,{children:"Total"}),e.jsx(n,{children:"Payment"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(Z,{children:C.map(t=>e.jsxs(A,{children:[e.jsx(i,{children:e.jsx("div",{className:"text-sm",children:new Date(t.transactionDate).toLocaleDateString()})}),e.jsx(i,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.patientName}),e.jsx("div",{className:"text-sm text-gray-500",children:t.testOrderId})]})}),e.jsx(i,{children:e.jsxs("div",{className:"text-sm flex items-center gap-1",children:[e.jsx(I,{className:"h-3 w-3 text-blue-500"}),t.testName]})}),e.jsx(i,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium",children:["$",t.insuranceClaim.toFixed(2)]}),t.insuranceProvider&&e.jsx("div",{className:"text-xs text-gray-500",children:t.insuranceProvider}),t.claimStatus&&$(t.claimStatus)]})}),e.jsx(i,{children:e.jsxs("div",{className:"text-sm font-medium",children:["$",t.patientCopay.toFixed(2)]})}),e.jsx(i,{children:e.jsxs("div",{className:"text-sm font-medium",children:["$",t.totalAmount.toFixed(2)]})}),e.jsx(i,{children:e.jsx("div",{className:"text-sm",children:M(t.paymentMethod)})}),e.jsx(i,{children:B(t.status)}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{variant:"ghost",size:"sm","data-testid":"view-receipt",title:"View Receipt",children:e.jsx(y,{className:"h-4 w-4"})}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>O(t),"data-testid":"download-insurance-file",title:"Download Insurance File",className:"text-blue-600 hover:text-blue-800",children:e.jsx(_,{className:"h-4 w-4"})})]})})]},t.id))})]})}),C.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(I,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No transactions found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or filter criteria"})]})]})]})]})}export{se as default};
