import{as as Q,r as g,au as H,j as e,h as u,aC as G,ai as y,C as d,d as o,e as x,bn as q,g as m,bQ as z,bL as Z,f as K,I as W,N as v,O as C,Q as w,V as S,W as l,X,Y,Z as I,_ as n,$ as _,a0 as r,y as T,cZ as J,a1 as L}from"./index-B4rk5nfq.js";function te(){const{token:A}=Q(),[h,F]=g.useState(""),[j,$]=g.useState("all"),[p,D]=g.useState("all"),{data:i=[],isLoading:ee}=H({queryKey:["/api/laboratory/billing"],staleTime:3e4}),P=s=>{const t={completed:{color:"bg-green-100 text-green-800",text:"Completed"},pending:{color:"bg-yellow-100 text-yellow-800",text:"Pending"},failed:{color:"bg-red-100 text-red-800",text:"Failed"}},a=t[s]||t.completed;return e.jsx(L,{className:a.color,children:a.text})},B=s=>{if(!s)return null;const a={submitted:{color:"bg-blue-100 text-blue-800",text:"Submitted"},approved:{color:"bg-green-100 text-green-800",text:"Approved"},denied:{color:"bg-red-100 text-red-800",text:"Denied"},processing:{color:"bg-yellow-100 text-yellow-800",text:"Processing"}}[s];return a?e.jsx(L,{className:a.color,children:a.text}):null},R=s=>({cash:"ðŸ’µ Cash",card:"ðŸ’³ Card",insurance:"ðŸ¥ Insurance",check:"ðŸ“„ Check"})[s]||s,O=async s=>{try{if(!A){console.error("No authentication token found");return}const t=new Date().toLocaleDateString(),a=new Date(s.transactionDate).toLocaleDateString(),N=`INSURANCE CLAIM SUBMISSION
Laboratory: LABSAFE
Address: 789 Research Boulevard, Science City, SC 98765
Phone: 555-LAB-SAFE
Tax ID: 44-LABSAFE
CLIA Number: CLIA-LABSAFE-789

PATIENT INFORMATION
Name: ${s.patientName}
Test Order ID: ${s.testOrderId}
Service Date: ${a}

BILLING INFORMATION
Test Name: ${s.testName}
Insurance Provider: ${s.insuranceProvider||"N/A"}
Total Amount: $${s.totalAmount.toFixed(2)}
Insurance Claim: $${s.insuranceClaim.toFixed(2)}
Patient Copay: $${s.patientCopay.toFixed(2)}
Payment Method: ${s.paymentMethod}
Status: ${s.status}
Claim Status: ${s.claimStatus||"N/A"}

NOTES
${s.notes||"No additional notes"}

Generated: ${t}

---
This file is for insurance manual submission.
Please attach all required supporting documentation.
`,V=new Blob([N],{type:"text/plain"}),b=window.URL.createObjectURL(V),c=document.createElement("a");c.href=b,c.download=`insurance-claim-${s.testOrderId}-${s.patientName.replace(/\s+/g,"-")}.txt`,document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(b),document.body.removeChild(c),console.log("Insurance file downloaded successfully")}catch(t){console.error("Error downloading insurance file:",t)}},f=i.filter(s=>{const t=(s.patientName||"").toLowerCase().includes(h.toLowerCase())||(s.testName||"").toLowerCase().includes(h.toLowerCase())||(s.testOrderId||"").toLowerCase().includes(h.toLowerCase()),a=j==="all"||s.status===j,N=p==="all"||s.paymentMethod===p;return t&&a&&N}),M=i.reduce((s,t)=>s+t.totalAmount,0),E=i.reduce((s,t)=>s+t.insuranceClaim,0),k=i.reduce((s,t)=>s+t.patientCopay,0),U=i.filter(s=>s.status==="completed").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Laboratory Billing & Revenue"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track lab test payments, insurance claims, and financial reporting"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(u,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Export Report"]}),e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),"Generate Invoice"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx(q,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(m,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",M.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"This period"})]})]}),e.jsxs(d,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Insurance Claims"}),e.jsx(y,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(m,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",E.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Claimed from insurance"})]})]}),e.jsxs(d,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Patient Payments"}),e.jsx(z,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(m,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",k.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Patient copays & direct pay"})]})]}),e.jsxs(d,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Tests Completed"}),e.jsx(Z,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:U}),e.jsx("p",{className:"text-xs text-gray-500",children:"Completed this period"})]})]})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(x,{children:"Laboratory Transaction History"}),e.jsx(K,{children:"View and manage lab test billing transactions"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(W,{placeholder:"Search transactions...",value:h,onChange:s=>F(s.target.value),className:"w-80"}),e.jsxs(v,{value:j,onValueChange:$,children:[e.jsx(C,{className:"w-32",children:e.jsx(w,{placeholder:"Status"})}),e.jsxs(S,{children:[e.jsx(l,{value:"all",children:"All Status"}),e.jsx(l,{value:"completed",children:"Completed"}),e.jsx(l,{value:"pending",children:"Pending"}),e.jsx(l,{value:"failed",children:"Failed"})]})]}),e.jsxs(v,{value:p,onValueChange:D,children:[e.jsx(C,{className:"w-32",children:e.jsx(w,{placeholder:"Payment"})}),e.jsxs(S,{children:[e.jsx(l,{value:"all",children:"All Methods"}),e.jsx(l,{value:"cash",children:"Cash"}),e.jsx(l,{value:"card",children:"Card"}),e.jsx(l,{value:"insurance",children:"Insurance"}),e.jsx(l,{value:"check",children:"Check"})]})]})]})]})}),e.jsxs(m,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(X,{children:[e.jsx(Y,{children:e.jsxs(I,{children:[e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Patient"}),e.jsx(n,{children:"Lab Test"}),e.jsx(n,{children:"Insurance"}),e.jsx(n,{children:"Patient Pay"}),e.jsx(n,{children:"Total"}),e.jsx(n,{children:"Payment"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(_,{children:f.map(s=>e.jsxs(I,{children:[e.jsx(r,{children:e.jsx("div",{className:"text-sm",children:new Date(s.transactionDate).toLocaleDateString()})}),e.jsx(r,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.patientName}),e.jsx("div",{className:"text-sm text-gray-500",children:s.testOrderId})]})}),e.jsx(r,{children:e.jsxs("div",{className:"text-sm flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3 text-blue-500"}),s.testName]})}),e.jsx(r,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium",children:["$",s.insuranceClaim.toFixed(2)]}),s.insuranceProvider&&e.jsx("div",{className:"text-xs text-gray-500",children:s.insuranceProvider}),s.claimStatus&&B(s.claimStatus)]})}),e.jsx(r,{children:e.jsxs("div",{className:"text-sm font-medium",children:["$",s.patientCopay.toFixed(2)]})}),e.jsx(r,{children:e.jsxs("div",{className:"text-sm font-medium",children:["$",s.totalAmount.toFixed(2)]})}),e.jsx(r,{children:e.jsx("div",{className:"text-sm",children:R(s.paymentMethod)})}),e.jsx(r,{children:P(s.status)}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{variant:"ghost",size:"sm","data-testid":"view-receipt",title:"View Receipt",children:e.jsx(y,{className:"h-4 w-4"})}),e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>O(s),"data-testid":"download-insurance-file",title:"Download Insurance File",className:"text-blue-600 hover:text-blue-800",children:e.jsx(J,{className:"h-4 w-4"})})]})})]},s.id))})]})}),f.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(T,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No transactions found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or filter criteria"})]})]})]})]})}export{te as default};
